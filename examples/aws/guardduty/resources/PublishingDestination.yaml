$token: aws:guardduty/publishingDestination:PublishingDestination
properties:
  destinationArn:
    type: string
    description: |
      The bucket arn and prefix under which the findings get exported. Bucket-ARN is required, the prefix is optional and will be `AWSLogs/[Account-ID]/GuardDuty/[Region]/` if not provided
  destinationType:
    type: string
    description: |
      Currently there is only "S3" available as destination type which is also the default value
  detectorId:
    type: string
    description: |
      The detector ID of the GuardDuty.
  kmsKeyArn:
    type: string
    description: |
      The ARN of the KMS key used to encrypt GuardDuty findings. GuardDuty enforces this to be encrypted.
required:
  - destinationArn
  - detectorId
  - kmsKeyArn
inputProperties:
  destinationArn:
    type: string
    description: |
      The bucket arn and prefix under which the findings get exported. Bucket-ARN is required, the prefix is optional and will be `AWSLogs/[Account-ID]/GuardDuty/[Region]/` if not provided
  destinationType:
    type: string
    description: |
      Currently there is only "S3" available as destination type which is also the default value
  detectorId:
    type: string
    description: |
      The detector ID of the GuardDuty.
    willReplaceOnChanges: true
  kmsKeyArn:
    type: string
    description: |
      The ARN of the KMS key used to encrypt GuardDuty findings. GuardDuty enforces this to be encrypted.
requiredInputs:
  - destinationArn
  - detectorId
  - kmsKeyArn
stateInputs:
  description: |
    Input properties used for looking up and filtering PublishingDestination resources.
  properties:
    destinationArn:
      type: string
      description: |
        The bucket arn and prefix under which the findings get exported. Bucket-ARN is required, the prefix is optional and will be `AWSLogs/[Account-ID]/GuardDuty/[Region]/` if not provided
    destinationType:
      type: string
      description: |
        Currently there is only "S3" available as destination type which is also the default value
    detectorId:
      type: string
      description: |
        The detector ID of the GuardDuty.
      willReplaceOnChanges: true
    kmsKeyArn:
      type: string
      description: |
        The ARN of the KMS key used to encrypt GuardDuty findings. GuardDuty enforces this to be encrypted.
  type: object
